# Vite vs Webpack: нюансы сборки

В проекте на Vite обнаружил неожиданное (для меня) поведение: при загрузке чанка страницы, браузер также загружает чанки двух других, не связанных с ней, страниц:

```
./page-a.js
  ./page-b.js
  ./page-c.js
```

Почему так? Vite (rollup) **помещает общий компонент**, который используется в нескольких асинхронных чанках, **в один из них**. Другими словами, при загрузке любого из этих чанков, браузер вынужден загрузить и тот чанк, в котором находятся общий компонент.

Однако, это не является поведением по умолчанию. Всему виной параметр `experimentalMinChunkSize`. Без него, Vite выносит все общие компоненты в отдельные чанки. Даже если компонент весит всего 106 байт, как этот:

```javascript
import {c as o} from "./createIcon.js";
const c = o("24", "Stroked", "Cancel");
export {c as C};
```

В итоге получается, либо много маленьких чанков (поведение по умолчанию), либо браузер загружает много не связанного кода (при использовании параметра).

_На заметку: `experimentalMinChunkSize` работает не всегда и в проекте всё равно остаются микро-чанки._

Webpack работает иначе: **помещает копию компонента в каждый асинхронный чанк**, где этот компонент необходим, если его размер не превышает значения указанного в `splitChunks.minSize` (по умолчанию 20000 байт). В противном случае, компонент выносится в отдельный чанк.
